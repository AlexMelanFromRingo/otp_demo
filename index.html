<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HOTP Demo ‚Äî RFC 4226</title>
  <link rel="stylesheet" href="styles.css">
  <script type="module" src="js/app.js"></script>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <h1 id="page-title">HOTP –î–µ–º–æ ‚Äî –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ñ –ø–∞—Ä–æ–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ (RFC 4226)</h1>
    <div class="header-controls">
      <div class="lang-group">
        <button id="lang-uk" class="lang-btn active">UA</button>
        <button id="lang-en" class="lang-btn">EN</button>
        <button id="lang-ru" class="lang-btn">RU</button>
      </div>
      <button id="theme-toggle" class="icon-btn" title="Toggle theme">üåô</button>
    </div>
  </header>

  <!-- Tabs -->
  <nav class="tabs">
    <button class="tab-btn active" data-tab="section-demo" id="tab-demo">–î–µ–º–æ</button>
    <button class="tab-btn" data-tab="section-algorithm" id="tab-algorithm">–ê–ª–≥–æ—Ä–∏—Ç–º HOTP</button>
    <button class="tab-btn" data-tab="section-data" id="tab-data">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö</button>
    <button class="tab-btn" data-tab="section-about" id="tab-about">–ü—Ä–æ RFC 4226</button>
  </nav>

  <!-- Demo Section -->
  <main id="section-demo" class="tab-content active">

    <!-- Initial Setup -->
    <section class="setup-section" id="setup-section">
      <h2 id="setup-title">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏</h2>
      <p class="step-desc" id="setup-desc">–°–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º. –¶–µ —Ä–æ–±–∏—Ç—å—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.</p>

      <div class="setup-controls">
        <button id="btn-generate" class="btn btn-primary">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á</button>
        <button id="btn-import" class="btn btn-secondary">–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –∫–ª—é—á</button>
        <button id="btn-preset" class="btn btn-secondary">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥</button>
      </div>

      <div id="import-section" class="import-section hidden">
        <label id="import-label">–í–≤–µ–¥—ñ—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (Hex –∞–±–æ Base32):</label>
        <input type="text" id="import-input" class="input-field" placeholder="JBSWY3DPEHPK3PXP –∞–±–æ 48656C6C6F21...">
        <div class="import-actions">
          <button id="btn-import-ok" class="btn btn-primary">–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏</button>
          <button id="btn-import-cancel" class="btn btn-secondary">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </div>
        <div id="import-error" class="error-message"></div>
      </div>
    </section>

    <!-- Main Demo (hidden until key generated) -->
    <div id="demo-content" class="hidden">

      <!-- Two-panel layout: Server & Client -->
      <div class="panels-container">

        <!-- SERVER PANEL -->
        <section class="panel server-panel">
          <div class="panel-header server-header">
            <h2 id="server-title">üñ•Ô∏è –°–µ—Ä–≤–µ—Ä</h2>
            <span class="panel-badge" id="server-badge">–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è</span>
          </div>

          <div class="panel-content">
            <!-- Server's view of shared secret -->
            <div class="data-block">
              <h3 id="server-secret-title">–°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (–∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –ë–î)</h3>
              <div class="result-box">
                <span class="result-label">Hex</span>
                <code class="result-value" id="server-secret-hex"></code>
              </div>
              <div class="result-box">
                <span class="result-label">Base32</span>
                <code class="result-value" id="server-secret-base32"></code>
              </div>
            </div>

            <!-- Server's counter -->
            <div class="data-block">
              <h3 id="server-counter-title">–õ—ñ—á–∏–ª—å–Ω–∏–∫ —Å–µ—Ä–≤–µ—Ä–∞</h3>
              <p class="step-desc" id="server-counter-desc">–°–µ—Ä–≤–µ—Ä –∑–±–µ—Ä—ñ–≥–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ–π —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫. –¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é —Ç–æ–≥–æ –∂ –ø–∞—Ä–æ–ª—è.</p>
              <div class="counter-display">
                <span class="counter-value" id="server-counter">0</span>
                <span class="counter-label" id="server-counter-label">–ü–æ—Ç–æ—á–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫</span>
              </div>
            </div>

            <!-- Look-ahead window -->
            <div class="data-block">
              <h3 id="server-window-title">–í—ñ–∫–Ω–æ –¥–æ–ø—É—Å–∫—É (Look-ahead)</h3>
              <p class="step-desc" id="server-window-desc">–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î –ø–∞—Ä–æ–ª—ñ –¥–ª—è –ª—ñ—á–∏–ª—å–Ω–∏–∫—ñ–≤ –≤—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ + –≤—ñ–∫–Ω–æ. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫–ª—ñ—î–Ω—Ç—É "–≤–∏–ø–µ—Ä–µ–¥–∏—Ç–∏" —Å–µ—Ä–≤–µ—Ä –Ω–∞ –∫—ñ–ª—å–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ–π.</p>
              <div class="window-control">
                <label id="window-label">–†–æ–∑–º—ñ—Ä –≤—ñ–∫–Ω–∞:</label>
                <input type="number" id="window-size" class="input-small" value="5" min="1" max="20">
              </div>
              <div class="window-visual" id="window-visual">
                <!-- Generated by JS -->
              </div>
            </div>

            <!-- Verification input -->
            <div class="data-block">
              <h3 id="verify-title">–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è</h3>
              <div class="verify-section">
                <input type="text" id="verify-input" class="input-field input-otp" placeholder="000000" maxlength="6">
                <button id="btn-verify" class="btn btn-primary">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
              </div>
              <div id="verify-result" class="verify-result"></div>
              <div id="verify-details" class="verify-details hidden"></div>
            </div>

            <!-- Server logs -->
            <div class="data-block">
              <h3 id="server-log-title">–ñ—É—Ä–Ω–∞–ª –ø–æ–¥—ñ–π</h3>
              <div class="log-container" id="server-log">
                <div class="log-empty" id="log-empty">–ñ—É—Ä–Ω–∞–ª –ø–æ—Ä–æ–∂–Ω—ñ–π</div>
              </div>
              <button id="btn-clear-log" class="btn btn-secondary btn-small">–û—á–∏—Å—Ç–∏—Ç–∏ –∂—É—Ä–Ω–∞–ª</button>
            </div>
          </div>
        </section>

        <!-- CLIENT PANEL -->
        <section class="panel client-panel">
          <div class="panel-header client-header">
            <h2 id="client-title">üì± –ö–ª—ñ—î–Ω—Ç (–¢–æ–∫–µ–Ω)</h2>
            <span class="panel-badge" id="client-badge">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä OTP</span>
          </div>

          <div class="panel-content">
            <!-- Client's view of shared secret -->
            <div class="data-block">
              <h3 id="client-secret-title">–°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (–≤ –ø–∞–º'—è—Ç—ñ —Ç–æ–∫–µ–Ω–∞)</h3>
              <div class="result-box">
                <span class="result-label">Hex</span>
                <code class="result-value" id="client-secret-hex"></code>
              </div>
              <p class="step-desc secure-note" id="client-secret-note">‚ö†Ô∏è –¶–µ–π –∫–ª—é—á –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –ø–æ –º–µ—Ä–µ–∂—ñ –ø—ñ—Å–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó!</p>
            </div>

            <!-- Client's counter -->
            <div class="data-block">
              <h3 id="client-counter-title">–õ—ñ—á–∏–ª—å–Ω–∏–∫ –∫–ª—ñ—î–Ω—Ç–∞</h3>
              <p class="step-desc" id="client-counter-desc">–ö–ª—ñ—î–Ω—Ç –∑–±—ñ–ª—å—à—É—î –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–∞—Ä–æ–ª—è.</p>
              <div class="counter-display">
                <span class="counter-value" id="client-counter">0</span>
                <span class="counter-label" id="client-counter-label">–ü–æ—Ç–æ—á–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫</span>
              </div>
            </div>

            <!-- Generated OTP -->
            <div class="data-block otp-block">
              <h3 id="client-otp-title">–û–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π –ø–∞—Ä–æ–ª—å</h3>
              <div class="otp-display">
                <span class="otp-code" id="client-otp">------</span>
              </div>
              <button id="btn-generate-otp" class="btn btn-primary btn-large">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø–∞—Ä–æ–ª—å</button>
              <p class="step-desc" id="client-otp-note">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É, —â–æ–± –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π OTP. –õ—ñ—á–∏–ª—å–Ω–∏–∫ –∑–±—ñ–ª—å—à–∏—Ç—å—Å—è –Ω–∞ 1.</p>
            </div>

            <!-- Detailed algorithm steps (expandable) -->
            <div class="data-block">
              <button class="expand-btn" id="btn-expand-steps">
                <span id="expand-text">–ü–æ–∫–∞–∑–∞—Ç–∏ –∫—Ä–æ–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É</span>
                <span class="expand-icon">‚ñº</span>
              </button>

              <div id="algorithm-steps" class="algorithm-steps hidden">
                <!-- Step 1: Counter as bytes -->
                <div class="step-card mini">
                  <h4 id="step1-title">–ö—Ä–æ–∫ 1: –õ—ñ—á–∏–ª—å–Ω–∏–∫ ‚Üí –ë–∞–π—Ç–∏</h4>
                  <p class="step-desc" id="step1-desc">–õ—ñ—á–∏–ª—å–Ω–∏–∫ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –≤ 8 –±–∞–π—Ç (big-endian).</p>
                  <div class="result-box">
                    <span class="result-label" id="step1-label">–õ—ñ—á–∏–ª—å–Ω–∏–∫ (hex, 8 –±–∞–π—Ç)</span>
                    <code class="result-value" id="step1-value">0000000000000000</code>
                  </div>
                </div>

                <!-- Step 2: HMAC-SHA1 -->
                <div class="step-card mini">
                  <h4 id="step2-title">–ö—Ä–æ–∫ 2: HMAC-SHA1</h4>
                  <p class="step-desc" id="step2-desc">–û–±—á–∏—Å–ª—é—î–º–æ HMAC-SHA1(secret, counter_bytes).</p>
                  <div class="formula" id="step2-formula">HMAC = HMAC-SHA1(K, C)</div>
                  <div class="result-box">
                    <span class="result-label" id="step2-label">HMAC —Ä–µ–∑—É–ª—å—Ç–∞—Ç (20 –±–∞–π—Ç)</span>
                    <code class="result-value" id="step2-value">--------------------</code>
                  </div>
                </div>

                <!-- Step 3: Dynamic Truncation -->
                <div class="step-card mini">
                  <h4 id="step3-title">–ö—Ä–æ–∫ 3: –î–∏–Ω–∞–º—ñ—á–Ω–µ –æ–±—Ä—ñ–∑–∞–Ω–Ω—è</h4>
                  <p class="step-desc" id="step3-desc">–í–∏—Ç—è–≥—É—î–º–æ 4 –±–∞–π—Ç–∏ –∑ –ø–æ–∑–∏—Ü—ñ—ó offset = hmac[19] & 0x0F.</p>

                  <div class="substep">
                    <span class="substep-label" id="step3-offset-label">Offset:</span>
                    <code id="step3-offset">0</code>
                  </div>

                  <div class="byte-diagram" id="byte-diagram">
                    <!-- Generated by JS -->
                  </div>

                  <div class="result-grid">
                    <div class="result-box">
                      <span class="result-label" id="step3-extracted-label">–í–∏—Ç—è–≥–Ω—É—Ç—ñ –±–∞–π—Ç–∏</span>
                      <code class="result-value" id="step3-extracted">00000000</code>
                    </div>
                    <div class="result-box">
                      <span class="result-label" id="step3-int-label">31-–±—ñ—Ç–Ω–µ —á–∏—Å–ª–æ</span>
                      <code class="result-value" id="step3-int">0</code>
                    </div>
                  </div>
                </div>

                <!-- Step 4: Modulo -->
                <div class="step-card mini">
                  <h4 id="step4-title">–ö—Ä–æ–∫ 4: –ú–æ–¥—É–ª–æ 10‚Å∂</h4>
                  <p class="step-desc" id="step4-desc">–ó–∞–ª–∏—à–æ–∫ –≤—ñ–¥ –¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ 1,000,000 –¥–∞—î 6-–∑–Ω–∞—á–Ω–∏–π –∫–æ–¥.</p>
                  <div class="formula" id="step4-formula">HOTP = Sbits mod 10‚Å∂</div>
                  <div class="result-box">
                    <span class="result-label" id="step4-calc-label">–û–±—á–∏—Å–ª–µ–Ω–Ω—è</span>
                    <code class="result-value" id="step4-calc">0 mod 1000000 = 0</code>
                  </div>
                  <div class="result-box result-final">
                    <span class="result-label">HOTP</span>
                    <code class="result-value result-code" id="step4-result">000000</code>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

      </div><!-- /panels-container -->

      <!-- Synchronization demo -->
      <section class="sync-section">
        <h2 id="sync-title">–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó</h2>

        <div class="data-block">
          <h3 data-i18n="sync-problem-title">–ü—Ä–æ–±–ª–µ–º–∞ –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó</h3>
          <p class="step-desc" data-i18n="sync-problem-desc">–ö–ª—ñ—î–Ω—Ç –º–æ–∂–µ "–≤–∏–ø–µ—Ä–µ–¥–∏—Ç–∏" —Å–µ—Ä–≤–µ—Ä, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–≥–µ–Ω–µ—Ä—É–≤–∞–≤ –ø–∞—Ä–æ–ª—ñ, –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ —ó—Ö. –°–µ—Ä–≤–µ—Ä –≤–∏—Ä—ñ—à—É—î —Ü–µ —á–µ—Ä–µ–∑ <strong>–≤—ñ–∫–Ω–æ –¥–æ–ø—É—Å–∫—É</strong> ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–µ —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç–æ—á–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫, –∞ –π –∫—ñ–ª—å–∫–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö.</p>
        </div>

        <div class="data-block">
          <h3 data-i18n="sync-scenarios-title">–°–ø—Ä–æ–±—É–π—Ç–µ —Å—Ü–µ–Ω–∞—Ä—ñ—ó</h3>
          <div class="sync-scenarios">
            <div class="scenario-card success-scenario">
              <h4 data-i18n="sync-within-window">–í –º–µ–∂–∞—Ö –≤—ñ–∫–Ω–∞</h4>
              <p class="step-desc" data-i18n="sync-within-desc">–ö–ª—ñ—î–Ω—Ç –≤–∏–ø–µ—Ä–µ–¥–∏–≤ –Ω–∞ 3, –≤—ñ–∫–Ω–æ = 5. –ü–∞—Ä–æ–ª—å –±—É–¥–µ –ø—Ä–∏–π–Ω—è—Ç–æ.</p>
              <button id="btn-desync-ok" class="btn btn-success" data-i18n="btn-desync-ok">+3 (–≤ –º–µ–∂–∞—Ö)</button>
            </div>

            <div class="scenario-card fail-scenario">
              <h4 data-i18n="sync-outside-window">–ó–∞ –º–µ–∂–∞–º–∏ –≤—ñ–∫–Ω–∞</h4>
              <p class="step-desc" data-i18n="sync-outside-desc">–ö–ª—ñ—î–Ω—Ç –≤–∏–ø–µ—Ä–µ–¥–∏–≤ –∑–∞–Ω–∞–¥—Ç–æ —Å–∏–ª—å–Ω–æ. –ü–∞—Ä–æ–ª—å –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ!</p>
              <button id="btn-desync-fail" class="btn btn-danger" data-i18n="btn-desync-fail">+–≤—ñ–∫–Ω–æ+3</button>
            </div>

            <div class="scenario-card neutral-scenario">
              <h4 data-i18n="sync-custom-value">–°–≤–æ—î –∑–Ω–∞—á–µ–Ω–Ω—è</h4>
              <div class="manual-desync">
                <input type="number" id="desync-amount" class="input-small" value="2" min="1" max="50">
                <button id="btn-desync-manual" class="btn btn-warning">+N</button>
              </div>
            </div>
          </div>
        </div>

        <div class="data-block">
          <h3 data-i18n="sync-visualization">–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è</h3>
          <div class="sync-counters-row">
            <div class="sync-counter-box server-box">
              <span class="sync-counter-label" data-i18n="sync-server-label">üñ•Ô∏è –°–µ—Ä–≤–µ—Ä</span>
              <span class="sync-counter-value" id="sync-server">0</span>
            </div>

            <div class="sync-diff">
              <span class="diff-label" data-i18n="sync-diff-label">–†—ñ–∑–Ω–∏—Ü—è</span>
              <span class="diff-value" id="diff-value">0</span>
            </div>

            <div class="sync-counter-box client-box">
              <span class="sync-counter-label" data-i18n="sync-client-label">üì± –ö–ª—ñ—î–Ω—Ç</span>
              <span class="sync-counter-value" id="sync-client">0</span>
            </div>
          </div>

          <div class="sync-window-visual">
            <div class="window-legend">
              <span class="legend-item"><span class="legend-color current"></span> <span data-i18n="legend-server">–°–µ—Ä–≤–µ—Ä</span></span>
              <span class="legend-item"><span class="legend-color in-window"></span> <span data-i18n="legend-window">–í—ñ–∫–Ω–æ</span></span>
              <span class="legend-item"><span class="legend-color client-pos"></span> <span data-i18n="legend-client">–ö–ª—ñ—î–Ω—Ç</span></span>
              <span class="legend-item"><span class="legend-color outside"></span> <span data-i18n="legend-outside">–ü–æ–∑–∞ –≤—ñ–∫–Ω–æ–º</span></span>
            </div>
            <div class="sync-window" id="sync-window"></div>
            <div class="window-status" id="window-status"></div>
          </div>

          <div class="sync-actions">
            <button id="btn-test-verify" class="btn btn-primary" data-i18n="btn-test-verify">–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—é</button>
            <button id="btn-resync" class="btn btn-secondary" data-i18n="btn-resync">–°–∫–∏–Ω—É—Ç–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∏</button>
          </div>

          <div id="sync-test-result" class="sync-test-result"></div>
        </div>

        <!-- How to fix desync -->
        <div class="data-block">
          <h3 data-i18n="resync-title">–Ø–∫ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é?</h3>
          <p class="step-desc" data-i18n="resync-intro">–Ø–∫—â–æ –∫–ª—ñ—î–Ω—Ç –≤–∏–ø–µ—Ä–µ–¥–∏–≤ —Å–µ—Ä–≤–µ—Ä –∑–∞ –º–µ–∂—ñ –≤—ñ–∫–Ω–∞, —î –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è:</p>

          <div class="resync-methods">
            <div class="resync-method">
              <h4 data-i18n="resync-method1-title">1. –ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó (RFC 4226 ¬ß7.4)</h4>
              <p data-i18n="resync-method1-desc">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å <strong>2-3 –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö OTP</strong>. –°–µ—Ä–≤–µ—Ä —à—É–∫–∞—î —Ü—é –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —É –≤–µ–ª–∏–∫–æ–º—É –≤—ñ–∫–Ω—ñ (100-1000). –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–∞.</p>
              <div class="resync-example">
                <code id="resync-example-code">
–ö–ª—ñ—î–Ω—Ç: counter = 150 (–≤–∏–ø–µ—Ä–µ–¥–∏–≤ –Ω–∞ 100)
–°–µ—Ä–≤–µ—Ä: counter = 50, –≤—ñ–∫–Ω–æ = 5

–ó–≤–∏—á–∞–π–Ω–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è: ‚úó (50+5 < 150)

–†–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è:
  –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å OTP –¥–ª—è 150, 151
  –°–µ—Ä–≤–µ—Ä —à—É–∫–∞—î –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ 50-1050
  –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó 150
  –°–µ—Ä–≤–µ—Ä –æ–Ω–æ–≤–ª—é—î: counter = 152 ‚úì
                </code>
              </div>
            </div>

            <div class="resync-method">
              <h4 data-i18n="resync-method2-title">2. –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–µ —Å–∫–∏–¥–∞–Ω–Ω—è</h4>
              <p data-i18n="resync-method2-desc">–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Ä—É—á–Ω—É —Å–∫–∏–¥–∞—î –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞. –ü–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (–ø–∞—Ä–æ–ª—å, email, —Ç–µ–ª–µ—Ñ–æ–Ω).</p>
            </div>

            <div class="resync-method">
              <h4 data-i18n="resync-method3-title">3. –ü–µ—Ä–µ—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω–∞</h4>
              <p data-i18n="resync-method3-desc">–í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–æ–≥–æ —Å–µ–∫—Ä–µ—Ç—É —ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ. –ù–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π, –∞–ª–µ –Ω–∞–π–º–µ–Ω—à –∑—Ä—É—á–Ω–∏–π —Å–ø–æ—Å—ñ–±.</p>
            </div>
          </div>

          <div class="resync-note">
            <strong data-i18n="resync-note-title">–ß–æ–º—É –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ –≤—ñ–∫–Ω–æ?</strong>
            <p data-i18n="resync-note-desc">–í–µ–ª–∏–∫–µ –≤—ñ–∫–Ω–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 1000) –∑–Ω–∏–∂—É—î –±–µ–∑–ø–µ–∫—É. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫, —è–∫–∏–π –ø–µ—Ä–µ—Ö–æ–ø–∏–≤ OTP, –º–∞—î –±—ñ–ª—å—à–µ —á–∞—Å—É –Ω–∞ brute-force –∞—Ç–∞–∫—É. RFC —Ä–µ–∫–æ–º–µ–Ω–¥—É—î –≤—ñ–∫–Ω–æ 3-10 –¥–ª—è –∑–≤–∏—á–∞–π–Ω–æ—ó —Ä–æ–±–æ—Ç–∏.</p>
          </div>
        </div>
      </section>

    </div><!-- /demo-content -->
  </main>

  <!-- Algorithm Section - Interactive Tutorial -->
  <section id="section-algorithm" class="tab-content">
    <article class="tutorial-content">

      <!-- Introduction -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-title">–ê–ª–≥–æ—Ä–∏—Ç–º HOTP ‚Äî –ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è</h2>
        <div class="intro-box">
          <p data-i18n="algo-intro"><strong>HOTP</strong> (HMAC-based One-Time Password) ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏—Ö –ø–∞—Ä–æ–ª—ñ–≤ –∑ RFC 4226 (–≥—Ä—É–¥–µ–Ω—å 2005).</p>
          <p class="important-note" data-i18n="algo-important-note">–í–∞–∂–ª–∏–≤–æ: –î–∏–Ω–∞–º—ñ—á–Ω–µ —É—Å—ñ—á–µ–Ω–Ω—è (Dynamic Truncation) ‚Äî —Ü–µ –≤–∏–Ω–∞—Ö—ñ–¥ —Å–∞–º–µ HOTP! TOTP (RFC 6238, 2011) –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î HOTP –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ, –∑–∞–º—ñ–Ω—é—é—á–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –Ω–∞ <code>floor(unix_time / 30)</code>.</p>
        </div>

        <div class="formula-box">
          <h3 data-i18n="algo-formula-title">–ó–∞–≥–∞–ª—å–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞</h3>
          <code class="big-formula">HOTP(K, C) = Truncate(HMAC-SHA1(K, C)) mod 10<sup>6</sup></code>
          <div class="formula-legend">
            <span data-i18n="algo-formula-k"><strong>K</strong> ‚Äî —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (20 –±–∞–π—Ç)</span>
            <span data-i18n="algo-formula-c"><strong>C</strong> ‚Äî –ª—ñ—á–∏–ª—å–Ω–∏–∫ (8 –±–∞–π—Ç)</span>
            <span data-i18n="algo-formula-truncate"><strong>Truncate</strong> ‚Äî –¥–∏–Ω–∞–º—ñ—á–Ω–µ —É—Å—ñ—á–µ–Ω–Ω—è</span>
          </div>
        </div>
      </div>

      <!-- Step 0: What we have -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-step0-title">–ö—Ä–æ–∫ 0: –©–æ –º–∏ –º–∞—î–º–æ –Ω–∞ –ø–æ—á–∞—Ç–∫—É</h2>

        <div class="explanation-block">
          <h3 data-i18n="algo-secret-title">–°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á (K)</h3>
          <p data-i18n="algo-secret-desc">–°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á ‚Äî —Ü–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –±–∞–π—Ç—ñ–≤, —è–∫–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —ñ –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ, —ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ. –¶–µ —î–¥–∏–Ω–∏–π —Å–µ–∫—Ä–µ—Ç, —è–∫–∏–π –≤–æ–Ω–∏ –¥—ñ–ª—è—Ç—å –º—ñ–∂ —Å–æ–±–æ—é.</p>

          <div class="visual-example">
            <div class="example-label" data-i18n="algo-secret-example">–ü—Ä–∏–∫–ª–∞–¥: —Ç–µ–∫—Å—Ç "12345678901234567890" (20 —Å–∏–º–≤–æ–ª—ñ–≤ ASCII)</div>
            <div class="byte-row">
              <div class="byte-with-label">
                <span class="byte-char">'1'</span>
                <span class="byte-hex">31</span>
              </div>
              <div class="byte-with-label">
                <span class="byte-char">'2'</span>
                <span class="byte-hex">32</span>
              </div>
              <div class="byte-with-label">
                <span class="byte-char">'3'</span>
                <span class="byte-hex">33</span>
              </div>
              <div class="byte-with-label">
                <span class="byte-char">'4'</span>
                <span class="byte-hex">34</span>
              </div>
              <div class="byte-with-label">
                <span class="byte-char">'5'</span>
                <span class="byte-hex">35</span>
              </div>
              <span class="ellipsis">...</span>
              <div class="byte-with-label">
                <span class="byte-char">'0'</span>
                <span class="byte-hex">30</span>
              </div>
            </div>
            <p class="example-note" data-i18n="algo-secret-note">–¶–µ —Ç–µ—Å—Ç–æ–≤–∏–π –∫–ª—é—á –∑ RFC 4226. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—ñ –∫–ª—é—á ‚Äî –≤–∏–ø–∞–¥–∫–æ–≤—ñ –±–∞–π—Ç–∏!</p>
          </div>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-counter-title">–õ—ñ—á–∏–ª—å–Ω–∏–∫ (C)</h3>
          <p data-i18n="algo-counter-desc">–õ—ñ—á–∏–ª—å–Ω–∏–∫ ‚Äî —Ü–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ, —è–∫–µ –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è –Ω–∞ 1 –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–∞—Ä–æ–ª—é. –ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ 0.</p>

          <div class="counter-example">
            <span class="counter-label" data-i18n="algo-counter-label">–õ—ñ—á–∏–ª—å–Ω–∏–∫ =</span>
            <span class="counter-number">5</span>
            <span class="counter-note" data-i18n="algo-counter-note">(–∑–≤–∏—á–∞–π–Ω–µ —Ü—ñ–ª–µ —á–∏—Å–ª–æ)</span>
          </div>
        </div>
      </div>

      <!-- Step 1: Counter to Bytes -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-step1-title">–ö—Ä–æ–∫ 1: –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –≤ –±–∞–π—Ç–∏</h2>

        <div class="explanation-block">
          <h3 data-i18n="algo-why-convert">–ù–∞–≤—ñ—â–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—Ç–∏?</h3>
          <p data-i18n="algo-why-convert-desc">HMAC-SHA1 –ø—Ä–∞—Ü—é—î –∑ <em>–±–∞–π—Ç–∞–º–∏</em>, –∞ –Ω–µ –∑ —á–∏—Å–ª–∞–º–∏. –¢–æ–º—É –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —á–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 5) –≤ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±–∞–π—Ç—ñ–≤.</p>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-why-8bytes">–ß–æ–º—É —Å–∞–º–µ 8 –±–∞–π—Ç?</h3>
          <p data-i18n="algo-why-8bytes-desc">RFC 4226 –≤–∏–º–∞–≥–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ 64-–±—ñ—Ç–Ω–∏–π (8-–±–∞–π—Ç–Ω–∏–π) –ª—ñ—á–∏–ª—å–Ω–∏–∫. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –º–∞—Ç–∏ –¥–æ 2<sup>64</sup> = 18,446,744,073,709,551,616 –º–æ–∂–ª–∏–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å ‚Äî –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –Ω–∞ –º—ñ–ª—å—è—Ä–¥–∏ —Ä–æ–∫—ñ–≤!</p>
        </div>

        <div class="explanation-block important">
          <h3 data-i18n="algo-endian-title">Big-Endian vs Little-Endian ‚Äî —â–æ —Ü–µ?</h3>

          <p data-i18n="algo-endian-intro">–ö–æ–ª–∏ –º–∏ –∑–∞–ø–∏—Å—É—î–º–æ —á–∏—Å–ª–æ —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±–∞–π—Ç—ñ–≤, –ø–æ—Å—Ç–∞—î –ø–∏—Ç–∞–Ω–Ω—è: <strong>–∑ —è–∫–æ–≥–æ –∫—ñ–Ω—Ü—è –ø–æ—á–∏–Ω–∞—Ç–∏?</strong></p>

          <div class="endian-comparison">
            <div class="endian-box">
              <h4 data-i18n="algo-big-endian">Big-Endian (—Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç –ø–µ—Ä—à–∏–º)</h4>
              <p data-i18n="algo-big-endian-desc">–Ø–∫ –º–∏ —á–∏—Ç–∞—î–º–æ —á–∏—Å–ª–∞: –∑–ª—ñ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ, —Å—Ç–∞—Ä—à—ñ —Ä–æ–∑—Ä—è–¥–∏ —Å–ø–æ—á–∞—Ç–∫—É.</p>
              <div class="endian-example">
                <span class="number-label">–ß–∏—Å–ª–æ 256 =</span>
                <div class="endian-bytes">
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte accent">01</div>
                  <div class="endian-byte accent">00</div>
                </div>
              </div>
              <p class="endian-note">256 = 1√ó256 + 0√ó1 = 0x0100</p>
            </div>

            <div class="endian-box">
              <h4 data-i18n="algo-little-endian">Little-Endian (–º–æ–ª–æ–¥—à–∏–π –±–∞–π—Ç –ø–µ—Ä—à–∏–º)</h4>
              <p data-i18n="algo-little-endian-desc">–Ø–∫ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –¥–∞–Ω—ñ –±—ñ–ª—å—à—ñ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ (Intel, AMD).</p>
              <div class="endian-example">
                <span class="number-label">–ß–∏—Å–ª–æ 256 =</span>
                <div class="endian-bytes">
                  <div class="endian-byte accent">00</div>
                  <div class="endian-byte accent">01</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                  <div class="endian-byte highlight">00</div>
                </div>
              </div>
              <p class="endian-note">–ë–∞–π—Ç–∏ –≤ –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É!</p>
            </div>
          </div>

          <div class="key-point" data-i18n="algo-endian-key">
            <strong>RFC 4226 –≤–∏–º–∞–≥–∞—î Big-Endian!</strong> –¶–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.
          </div>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-practical-example">–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥</h3>

          <div class="step-by-step">
            <div class="conversion-step">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>–ú–∞—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫: <code>C = 5</code></p>
              </div>
            </div>

            <div class="conversion-step">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>–í —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ: <code>5 = 0x05</code></p>
              </div>
            </div>

            <div class="conversion-step">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>–†–æ–∑—à–∏—Ä—é—î–º–æ –¥–æ 8 –±–∞–π—Ç (–¥–æ–ø–æ–≤–Ω—é—î–º–æ –Ω—É–ª—è–º–∏ –∑–ª—ñ–≤–∞):</p>
                <div class="byte-result">
                  <span class="byte">00</span>
                  <span class="byte">00</span>
                  <span class="byte">00</span>
                  <span class="byte">00</span>
                  <span class="byte">00</span>
                  <span class="byte">00</span>
                  <span class="byte">00</span>
                  <span class="byte accent">05</span>
                </div>
              </div>
            </div>
          </div>

          <div class="more-examples">
            <h4 data-i18n="algo-more-examples">–©–µ –ø—Ä–∏–∫–ª–∞–¥–∏:</h4>
            <table class="examples-table">
              <tr>
                <th data-i18n="algo-table-counter">–õ—ñ—á–∏–ª—å–Ω–∏–∫</th>
                <th data-i18n="algo-table-bytes">8 –±–∞–π—Ç (Big-Endian)</th>
              </tr>
              <tr>
                <td>0</td>
                <td><code>00 00 00 00 00 00 00 00</code></td>
              </tr>
              <tr>
                <td>1</td>
                <td><code>00 00 00 00 00 00 00 01</code></td>
              </tr>
              <tr>
                <td>255</td>
                <td><code>00 00 00 00 00 00 00 FF</code></td>
              </tr>
              <tr>
                <td>256</td>
                <td><code>00 00 00 00 00 00 01 00</code></td>
              </tr>
              <tr>
                <td>1000000</td>
                <td><code>00 00 00 00 00 0F 42 40</code></td>
              </tr>
            </table>
          </div>
        </div>
      </div>

      <!-- Step 2: HMAC-SHA1 -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-step2-title">–ö—Ä–æ–∫ 2: –û–±—á–∏—Å–ª–µ–Ω–Ω—è HMAC-SHA1</h2>

        <div class="explanation-block">
          <h3 data-i18n="algo-what-hmac">–©–æ —Ç–∞–∫–µ HMAC?</h3>
          <p data-i18n="algo-what-hmac-desc"><strong>HMAC</strong> (Hash-based Message Authentication Code) ‚Äî —Ü–µ —Å–ø–æ—Å—ñ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ "–ø—ñ–¥–ø–∏—Å" –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á.</p>

          <div class="hmac-diagram">
            <div class="hmac-input">
              <div class="hmac-box key-box">
                <span class="box-label">–ö–ª—é—á K</span>
                <span class="box-content">31 32 33 ... (20 –±–∞–π—Ç)</span>
              </div>
              <div class="hmac-box data-box">
                <span class="box-label">–î–∞–Ω—ñ C</span>
                <span class="box-content">00 00 00 00 00 00 00 05</span>
              </div>
            </div>
            <div class="hmac-arrow">‚Üì HMAC-SHA1</div>
            <div class="hmac-output">
              <div class="hmac-box result-box">
                <span class="box-label">–†–µ–∑—É–ª—å—Ç–∞—Ç (–∑–∞–≤–∂–¥–∏ 20 –±–∞–π—Ç)</span>
                <span class="box-content">1f 86 98 69 0e 02 ca 16 61 85 50 ef 7f 19 da 8e 94 5b 55 5a</span>
              </div>
            </div>
          </div>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-why-sha1">–ß–æ–º—É SHA-1?</h3>
          <p data-i18n="algo-why-sha1-desc">RFC 4226 –±—É–≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–π —É 2005 —Ä–æ—Ü—ñ, –∫–æ–ª–∏ SHA-1 –±—É–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º. –•–æ—á–∞ SHA-1 –º–∞—î —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –∫–æ–ª—ñ–∑—ñ–π, –¥–ª—è HMAC —Ü–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ ‚Äî HMAC –∑–∞—Ö–∏—â–µ–Ω–∏–π –≤—ñ–¥ —Ç–∞–∫–∏—Ö –∞—Ç–∞–∫.</p>
          <p class="note" data-i18n="algo-sha1-note">–°—É—á–∞—Å–Ω–∏–π TOTP —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î SHA-256 –∞–±–æ SHA-512, –∞–ª–µ SHA-1 –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —Å—É–º—ñ—Å–Ω–∏–º.</p>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-hmac-result">–†–µ–∑—É–ª—å—Ç–∞—Ç HMAC-SHA1</h3>
          <p data-i18n="algo-hmac-result-desc">HMAC-SHA1 <strong>–∑–∞–≤–∂–¥–∏</strong> –ø–æ–≤–µ—Ä—Ç–∞—î —Ä—ñ–≤–Ω–æ 20 –±–∞–π—Ç (160 –±—ñ—Ç), –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö.</p>

          <div class="hmac-result-example">
            <p data-i18n="algo-hmac-example">–î–ª—è –∫–ª—é—á–∞ "12345678901234567890" —ñ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ 5:</p>
            <div class="byte-grid">
              <div class="byte-cell"><span class="idx">0</span><span class="val">1f</span></div>
              <div class="byte-cell"><span class="idx">1</span><span class="val">86</span></div>
              <div class="byte-cell"><span class="idx">2</span><span class="val">98</span></div>
              <div class="byte-cell"><span class="idx">3</span><span class="val">69</span></div>
              <div class="byte-cell"><span class="idx">4</span><span class="val">0e</span></div>
              <div class="byte-cell"><span class="idx">5</span><span class="val">02</span></div>
              <div class="byte-cell"><span class="idx">6</span><span class="val">ca</span></div>
              <div class="byte-cell"><span class="idx">7</span><span class="val">16</span></div>
              <div class="byte-cell"><span class="idx">8</span><span class="val">61</span></div>
              <div class="byte-cell"><span class="idx">9</span><span class="val">85</span></div>
              <div class="byte-cell"><span class="idx">10</span><span class="val">50</span></div>
              <div class="byte-cell"><span class="idx">11</span><span class="val">ef</span></div>
              <div class="byte-cell"><span class="idx">12</span><span class="val">7f</span></div>
              <div class="byte-cell"><span class="idx">13</span><span class="val">19</span></div>
              <div class="byte-cell"><span class="idx">14</span><span class="val">da</span></div>
              <div class="byte-cell"><span class="idx">15</span><span class="val">8e</span></div>
              <div class="byte-cell"><span class="idx">16</span><span class="val">94</span></div>
              <div class="byte-cell"><span class="idx">17</span><span class="val">5b</span></div>
              <div class="byte-cell"><span class="idx">18</span><span class="val">55</span></div>
              <div class="byte-cell offset-source"><span class="idx">19</span><span class="val">5a</span></div>
            </div>
            <p class="byte-grid-note" data-i18n="algo-hmac-note">–Ü–Ω–¥–µ–∫—Å–∏ –≤—ñ–¥ 0 –¥–æ 19. –û—Å—Ç–∞–Ω–Ω—ñ–π –±–∞–π—Ç (—ñ–Ω–¥–µ–∫—Å 19) –≤–∏–¥—ñ–ª–µ–Ω–æ ‚Äî –≤—ñ–Ω –±—É–¥–µ –≤–∞–∂–ª–∏–≤–∏–º!</p>
          </div>
        </div>
      </div>

      <!-- Step 3: Dynamic Truncation -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-step3-title">–ö—Ä–æ–∫ 3: –î–∏–Ω–∞–º—ñ—á–Ω–µ —É—Å—ñ—á–µ–Ω–Ω—è (Dynamic Truncation)</h2>

        <div class="explanation-block important">
          <h3 data-i18n="algo-truncation-origin">–ó–≤—ñ–¥–∫–∏ –≤–∑—è–ª–æ—Å—å –¥–∏–Ω–∞–º—ñ—á–Ω–µ —É—Å—ñ—á–µ–Ω–Ω—è?</h3>
          <p data-i18n="algo-truncation-origin-desc">–¶–µ <strong>–≤–∏–Ω–∞—Ö—ñ–¥ RFC 4226 (HOTP)</strong>! TOTP –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –π–æ–≥–æ –±–µ–∑ –∑–º—ñ–Ω.</p>
          <p data-i18n="algo-truncation-problem">–ü—Ä–æ–±–ª–µ–º–∞: –£ –Ω–∞—Å —î 20 –±–∞–π—Ç (160 –±—ñ—Ç), –∞ –ø–æ—Ç—Ä—ñ–±–µ–Ω 6-–∑–Ω–∞—á–Ω–∏–π –∫–æ–¥. –Ø–∫ –≤–∏–±—Ä–∞—Ç–∏, —è–∫—ñ –±–∞–π—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏?</p>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-step31">–ö—Ä–æ–∫ 3.1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ—â–µ–Ω–Ω—è (offset)</h3>

          <p data-i18n="algo-step31-desc">–ë–µ—Ä–µ–º–æ <strong>–æ—Å—Ç–∞–Ω–Ω—ñ–π –±–∞–π—Ç</strong> HMAC —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (—ñ–Ω–¥–µ–∫—Å 19) —ñ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –º–∞—Å–∫—É <code>0x0F</code>:</p>

          <div class="offset-calculation">
            <div class="calc-step">
              <span class="calc-label">–û—Å—Ç–∞–Ω–Ω—ñ–π –±–∞–π—Ç:</span>
              <code>hmac[19] = 0x5A</code>
            </div>

            <div class="calc-step">
              <span class="calc-label">–í –¥–≤—ñ–π–∫–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ:</span>
              <div class="binary-display">
                <span class="binary-group high">0101</span>
                <span class="binary-group low">1010</span>
              </div>
              <span class="binary-note">—Å—Ç–∞—Ä—à—ñ 4 –±—ñ—Ç–∏ | –º–æ–ª–æ–¥—à—ñ 4 –±—ñ—Ç–∏</span>
            </div>

            <div class="calc-step">
              <span class="calc-label">–ú–∞—Å–∫–∞ 0x0F:</span>
              <div class="binary-display">
                <span class="binary-group">0000</span>
                <span class="binary-group">1111</span>
              </div>
            </div>

            <div class="calc-step">
              <span class="calc-label">–†–µ–∑—É–ª—å—Ç–∞—Ç (AND):</span>
              <div class="binary-display">
                <span class="binary-group">0000</span>
                <span class="binary-group accent">1010</span>
              </div>
              <span class="binary-result">= 10 (–¥–µ—Å—è—Ç–∫–æ–≤–µ)</span>
            </div>
          </div>

          <div class="key-point" data-i18n="algo-offset-result">
            <strong>offset = 10</strong> ‚Äî —Ü–µ –ø–æ–∑–∏—Ü—ñ—è, –∑ —è–∫–æ—ó –º–∏ –ø–æ—á–Ω–µ–º–æ –≤–∏—Ç—è–≥—É–≤–∞—Ç–∏ –±–∞–π—Ç–∏.
          </div>

          <div class="why-box">
            <h4 data-i18n="algo-why-mask">–ß–æ–º—É –º–∞—Å–∫–∞ 0x0F?</h4>
            <p data-i18n="algo-why-mask-desc">–ú–∞—Å–∫–∞ <code>0x0F = 00001111</code> –∑–∞–ª–∏—à–∞—î —Ç—ñ–ª—å–∫–∏ –º–æ–ª–æ–¥—à—ñ 4 –±—ñ—Ç–∏. –¶–µ –¥–∞—î —á–∏—Å–ª–∞ –≤—ñ–¥ 0 –¥–æ 15.</p>
            <p>–ß–æ–º—É 0-15? –ë–æ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏—Ç—è–≥—Ç–∏ 4 –±–∞–π—Ç–∏ –∑ 20-–±–∞–π—Ç–Ω–æ–≥–æ –º–∞—Å–∏–≤—É. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å —Å—Ç–∞—Ä—Ç—É = 20 - 4 = 16, –∞–ª–µ RFC –æ–±–º–µ–∂—É—î –¥–æ 15 –¥–ª—è –±–µ–∑–ø–µ–∫–∏.</p>
          </div>

          <div class="why-box">
            <h4 data-i18n="algo-why-last-byte">–ß–æ–º—É —Å–∞–º–µ –æ—Å—Ç–∞–Ω–Ω—ñ–π –±–∞–π—Ç?</h4>
            <p data-i18n="algo-why-last-byte-desc">–¶–µ –¥–æ–¥–∞—î <strong>–Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—Å—Ç—ñ</strong>. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–µ –º–æ–∂–µ –∑–Ω–∞—Ç–∏ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å, —è–∫—ñ –±–∞–π—Ç–∏ –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ. –ù–∞–≤—ñ—Ç—å –º–∞—é—á–∏ —á–∞—Å—Ç–∫–æ–≤–∏–π –¥–æ—Å—Ç—É–ø –¥–æ HMAC, –≤—ñ–Ω –Ω–µ –∑–Ω–∞—î, –¥–µ —à—É–∫–∞—Ç–∏.</p>
          </div>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-step32">–ö—Ä–æ–∫ 3.2: –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è 4 –±–∞–π—Ç—ñ–≤</h3>

          <p data-i18n="algo-step32-desc">–ü–æ—á–∏–Ω–∞—é—á–∏ –∑ –ø–æ–∑–∏—Ü—ñ—ó <code>offset = 10</code>, –≤–∏—Ç—è–≥—É—î–º–æ 4 –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –±–∞–π—Ç–∏:</p>

          <div class="extraction-visual">
            <div class="hmac-bytes-row">
              <div class="hbyte dim"><span class="idx">0</span>1f</div>
              <div class="hbyte dim"><span class="idx">1</span>86</div>
              <div class="hbyte dim"><span class="idx">2</span>98</div>
              <div class="hbyte dim"><span class="idx">3</span>69</div>
              <div class="hbyte dim"><span class="idx">4</span>0e</div>
              <div class="hbyte dim"><span class="idx">5</span>02</div>
              <div class="hbyte dim"><span class="idx">6</span>ca</div>
              <div class="hbyte dim"><span class="idx">7</span>16</div>
              <div class="hbyte dim"><span class="idx">8</span>61</div>
              <div class="hbyte dim"><span class="idx">9</span>85</div>
              <div class="hbyte extracted"><span class="idx">10</span>50</div>
              <div class="hbyte extracted"><span class="idx">11</span>ef</div>
              <div class="hbyte extracted"><span class="idx">12</span>7f</div>
              <div class="hbyte extracted"><span class="idx">13</span>19</div>
              <div class="hbyte dim"><span class="idx">14</span>da</div>
              <div class="hbyte dim"><span class="idx">15</span>8e</div>
              <div class="hbyte dim"><span class="idx">16</span>94</div>
              <div class="hbyte dim"><span class="idx">17</span>5b</div>
              <div class="hbyte dim"><span class="idx">18</span>55</div>
              <div class="hbyte offset-marker"><span class="idx">19</span>5a</div>
            </div>
            <div class="extraction-arrow">
              <span>offset=10 ‚Üí –≤–∏—Ç—è–≥—É—î–º–æ [10], [11], [12], [13]</span>
            </div>
            <div class="extracted-result">
              <span class="extracted-label">–í–∏—Ç—è–≥–Ω—É—Ç—ñ –±–∞–π—Ç–∏:</span>
              <code>50 ef 7f 19</code>
            </div>
          </div>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-step33">–ö—Ä–æ–∫ 3.3: –û–±–Ω—É–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä—à–æ–≥–æ –±—ñ—Ç—É ‚Äî —á–æ–º—É 31 –±—ñ—Ç, –∞ –Ω–µ 32?</h3>

          <p data-i18n="algo-step33-intro">–¶–µ <strong>–∫–ª—é—á–æ–≤–∏–π –º–æ–º–µ–Ω—Ç</strong>, —è–∫–∏–π —á–∞—Å—Ç–æ –≤–∏–∫–ª–∏–∫–∞—î –ø–ª—É—Ç–∞–Ω–∏–Ω—É!</p>

          <div class="bit-explanation">
            <h4 data-i18n="algo-signed-problem">–ü—Ä–æ–±–ª–µ–º–∞ –∑–Ω–∞–∫–æ–≤–∏—Ö —á–∏—Å–µ–ª</h4>
            <p data-i18n="algo-signed-desc">–£ –±–∞–≥–∞—Ç—å–æ—Ö –º–æ–≤–∞—Ö –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (Java, —Å—Ç–∞—Ä–∏–π JavaScript, C –∑ signed int) 32-–±—ñ—Ç–Ω—ñ —á–∏—Å–ª–∞ —î <strong>–∑–Ω–∞–∫–æ–≤–∏–º–∏</strong>. –¶–µ –æ–∑–Ω–∞—á–∞—î:</p>

            <div class="signed-unsigned">
              <div class="sign-box">
                <h5>–Ø–∫—â–æ —Å—Ç–∞—Ä—à–∏–π –±—ñ—Ç = 0</h5>
                <p>–ß–∏—Å–ª–æ –¥–æ–¥–∞—Ç–Ω–µ</p>
                <code>0xxx xxxx ... = 0 –¥–æ 2,147,483,647</code>
              </div>
              <div class="sign-box negative">
                <h5>–Ø–∫—â–æ —Å—Ç–∞—Ä—à–∏–π –±—ñ—Ç = 1</h5>
                <p>–ß–∏—Å–ª–æ –≤—ñ–¥'—î–º–Ω–µ!</p>
                <code>1xxx xxxx ... = -2,147,483,648 –¥–æ -1</code>
              </div>
            </div>

            <div class="solution-box">
              <h4 data-i18n="algo-solution-title">–†—ñ—à–µ–Ω–Ω—è: –æ–±–Ω—É–ª–∏—Ç–∏ —Å—Ç–∞—Ä—à–∏–π –±—ñ—Ç</h4>
              <p data-i18n="algo-solution-desc">–ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –º–∞—Å–∫—É <code>0x7F</code> –¥–æ –ø–µ—Ä—à–æ–≥–æ –±–∞–π—Ç—É:</p>

              <div class="mask-demo">
                <div class="mask-row">
                  <span class="mask-label">–ü–µ—Ä—à–∏–π –±–∞–π—Ç:</span>
                  <code>0x50 = <span class="bit">0</span>1010000</code>
                </div>
                <div class="mask-row">
                  <span class="mask-label">–ú–∞—Å–∫–∞ 0x7F:</span>
                  <code>0x7F = <span class="bit">0</span>1111111</code>
                </div>
                <div class="mask-row result">
                  <span class="mask-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                  <code>0x50 = <span class="bit">0</span>1010000</code>
                  <span class="mask-note">(–≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –Ω–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å)</span>
                </div>
              </div>

              <p>–Ø–∫–±–∏ –ø–µ—Ä—à–∏–π –±–∞–π—Ç –±—É–≤ <code>0xD0 = <span class="danger">1</span>1010000</code>, —Ç–æ –ø—ñ—Å–ª—è –º–∞—Å–∫–∏ —Å—Ç–∞–ª–æ –± <code>0x50 = <span class="safe">0</span>1010000</code>.</p>
            </div>
          </div>

          <div class="key-point" data-i18n="algo-31bit-result">
            <strong>–¢–µ–ø–µ—Ä —É –Ω–∞—Å –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ 31-–±—ñ—Ç–Ω–µ –¥–æ–¥–∞—Ç–Ω–µ —á–∏—Å–ª–æ!</strong>
            <p>–î—ñ–∞–ø–∞–∑–æ–Ω: –≤—ñ–¥ 0 –¥–æ 2<sup>31</sup>-1 = 2,147,483,647</p>
          </div>
        </div>

        <div class="explanation-block">
          <h3 data-i18n="algo-step34">–ö—Ä–æ–∫ 3.4: –ó–±—ñ—Ä–∫–∞ 32-–±—ñ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞</h3>

          <p data-i18n="algo-step34-desc">–¢–µ–ø–µ—Ä –∑–±–∏—Ä–∞—î–º–æ 4 –±–∞–π—Ç–∏ –≤ –æ–¥–Ω–µ —á–∏—Å–ª–æ (Big-Endian):</p>

          <div class="assembly-visual">
            <div class="assembly-step">
              <span class="byte-pos">–ë–∞–π—Ç 0 (—Å—Ç–∞—Ä—à–∏–π):</span>
              <code>0x50</code>
              <span class="shift">√ó 2¬≤‚Å¥ (–∑—Å—É–≤ –Ω–∞ 24 –±—ñ—Ç–∏)</span>
              <code class="result">= 0x50000000</code>
            </div>
            <div class="assembly-step">
              <span class="byte-pos">–ë–∞–π—Ç 1:</span>
              <code>0xEF</code>
              <span class="shift">√ó 2¬π‚Å∂ (–∑—Å—É–≤ –Ω–∞ 16 –±—ñ—Ç)</span>
              <code class="result">= 0x00EF0000</code>
            </div>
            <div class="assembly-step">
              <span class="byte-pos">–ë–∞–π—Ç 2:</span>
              <code>0x7F</code>
              <span class="shift">√ó 2‚Å∏ (–∑—Å—É–≤ –Ω–∞ 8 –±—ñ—Ç)</span>
              <code class="result">= 0x00007F00</code>
            </div>
            <div class="assembly-step">
              <span class="byte-pos">–ë–∞–π—Ç 3 (–º–æ–ª–æ–¥—à–∏–π):</span>
              <code>0x19</code>
              <span class="shift">√ó 2‚Å∞ (–±–µ–∑ –∑—Å—É–≤—É)</span>
              <code class="result">= 0x00000019</code>
            </div>
            <div class="assembly-total">
              <span>–°—É–º–∞ (OR):</span>
              <code>0x50EF7F19 = 1,357,872,921</code>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 4: Modulo -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-step4-title">–ö—Ä–æ–∫ 4: –û–ø–µ—Ä–∞—Ü—ñ—è –º–æ–¥—É–ª–æ</h2>

        <div class="explanation-block">
          <h3 data-i18n="algo-why-modulo">–ù–∞–≤—ñ—â–æ –º–æ–¥—É–ª–æ?</h3>
          <p data-i18n="algo-why-modulo-desc">–£ –Ω–∞—Å —î –≤–µ–ª–∏–∫–µ —á–∏—Å–ª–æ (–¥–æ 2 –º—ñ–ª—å—è—Ä–¥—ñ–≤), –∞ –ø–æ—Ç—Ä—ñ–±–µ–Ω 6-–∑–Ω–∞—á–Ω–∏–π –∫–æ–¥ (–≤—ñ–¥ 000000 –¥–æ 999999).</p>
          <p data-i18n="algo-modulo-def"><strong>–ú–æ–¥—É–ª–æ</strong> ‚Äî —Ü–µ –∑–∞–ª–∏—à–æ–∫ –≤—ñ–¥ –¥—ñ–ª–µ–Ω–Ω—è. –í—ñ–Ω –∑–∞–≤–∂–¥–∏ –º–µ–Ω—à–∏–π –∑–∞ –¥—ñ–ª—å–Ω–∏–∫.</p>
        </div>

        <div class="modulo-calculation">
          <div class="modulo-step">
            <span class="mod-label">–ù–∞—à–µ —á–∏—Å–ª–æ:</span>
            <code>1,357,872,921</code>
          </div>
          <div class="modulo-step">
            <span class="mod-label">–î—ñ–ª—å–Ω–∏–∫:</span>
            <code>10‚Å∂ = 1,000,000</code>
          </div>
          <div class="modulo-step">
            <span class="mod-label">–î—ñ–ª–µ–Ω–Ω—è:</span>
            <code>1,357,872,921 √∑ 1,000,000 = 1357.872921</code>
          </div>
          <div class="modulo-step">
            <span class="mod-label">–¶—ñ–ª–∞ —á–∞—Å—Ç–∏–Ω–∞:</span>
            <code>1357</code>
          </div>
          <div class="modulo-step">
            <span class="mod-label">–ó–∞–ª–∏—à–æ–∫:</span>
            <code>1,357,872,921 - (1357 √ó 1,000,000) = 872,921</code>
          </div>
          <div class="modulo-result">
            <span class="mod-label">OTP:</span>
            <code class="otp-result">872921</code>
          </div>
        </div>

        <div class="padding-note">
          <h4 data-i18n="algo-padding-title">–î–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω—É–ª—è–º–∏</h4>
          <p data-i18n="algo-padding-desc">–Ø–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–µ–Ω—à–∏–π –∑–∞ 100000, –¥–æ–¥–∞—î–º–æ –Ω—É–ª—ñ –∑–ª—ñ–≤–∞:</p>
          <ul>
            <li><code>1234</code> ‚Üí <code>001234</code></li>
            <li><code>42</code> ‚Üí <code>000042</code></li>
            <li><code>872921</code> ‚Üí <code>872921</code> (–≤–∂–µ 6 —Ü–∏—Ñ—Ä)</li>
          </ul>
        </div>
      </div>

      <!-- Server Verification -->
      <div class="tutorial-section">
        <h2 data-i18n="algo-server-verify-title">–Ø–∫ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î –ø–∞—Ä–æ–ª—å?</h2>

        <div class="explanation-block important">
          <h3 data-i18n="algo-server-same-math">–¢–∞–∫, —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ–Ω—É—î —Ç—É —Å–∞–º—É –º–∞—Ç–µ–º–∞—Ç–∏–∫—É!</h3>
          <p data-i18n="algo-server-desc">–°–µ—Ä–≤–µ—Ä –º–∞—î –∫–æ–ø—ñ—é —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ —ñ —Å–≤—ñ–π –ª—ñ—á–∏–ª—å–Ω–∏–∫. –ü—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –≤—ñ–Ω:</p>
        </div>

        <div class="server-flow">
          <div class="server-step">
            <span class="step-num">1</span>
            <div class="step-content">
              <p>–û—Ç—Ä–∏–º—É—î OTP –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: <code>872921</code></p>
            </div>
          </div>

          <div class="server-step">
            <span class="step-num">2</span>
            <div class="step-content">
              <p>–û–±—á–∏—Å–ª—é—î HOTP –¥–ª—è —Å–≤–æ–≥–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ —ñ –∫—ñ–ª—å–∫–æ—Ö –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö (–≤—ñ–∫–Ω–æ –¥–æ–ø—É—Å–∫—É):</p>
              <div class="server-calc">
                <div class="calc-row"><code>HOTP(K, C=3)</code> = 969429 ‚â† 872921</div>
                <div class="calc-row"><code>HOTP(K, C=4)</code> = 338314 ‚â† 872921</div>
                <div class="calc-row success"><code>HOTP(K, C=5)</code> = 254676 ‚â† 872921</div>
                <div class="calc-row"><code>HOTP(K, C=6)</code> = 287922 ‚â† 872921</div>
              </div>
              <p class="note">–£–ø—Å! –î–ª—è counter=5 —Å–ø—Ä–∞–≤–∂–Ω—ñ–π OTP ‚Äî 254676, –∞ –Ω–µ 872921. –Ø –ø–æ–º–∏–ª–∏–≤—Å—è –≤ –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏—â–µ. –î–∞–≤–∞–π—Ç–µ –≤–∏–ø—Ä–∞–≤–∏–º–æ...</p>
            </div>
          </div>
        </div>

        <div class="rfc-test-vectors">
          <h3 data-i18n="algo-test-vectors">–°–ø—Ä–∞–≤–∂–Ω—ñ —Ç–µ—Å—Ç–æ–≤—ñ –≤–µ–∫—Ç–æ—Ä–∏ –∑ RFC 4226</h3>
          <p data-i18n="algo-test-vectors-desc">–î–ª—è –∫–ª—é—á–∞ "12345678901234567890":</p>
          <table class="test-vectors-table">
            <tr><th>Counter</th><th>HOTP</th></tr>
            <tr><td>0</td><td>755224</td></tr>
            <tr><td>1</td><td>287082</td></tr>
            <tr><td>2</td><td>359152</td></tr>
            <tr><td>3</td><td>969429</td></tr>
            <tr><td>4</td><td>338314</td></tr>
            <tr><td>5</td><td>254676</td></tr>
            <tr><td>6</td><td>287922</td></tr>
            <tr><td>7</td><td>162583</td></tr>
            <tr><td>8</td><td>399871</td></tr>
            <tr><td>9</td><td>520489</td></tr>
          </table>
        </div>

        <div class="window-explanation">
          <h3 data-i18n="algo-window-title">–í—ñ–∫–Ω–æ –¥–æ–ø—É—Å–∫—É (Look-ahead Window)</h3>
          <p data-i18n="algo-window-desc">–ö–ª—ñ—î–Ω—Ç –º–æ–∂–µ "–≤–∏–ø–µ—Ä–µ–¥–∏—Ç–∏" —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤, –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ –ø–∞—Ä–æ–ª—ñ). –¢–æ–º—É —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–µ —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç–æ—á–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫, –∞ –π –∫—ñ–ª—å–∫–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö.</p>

          <div class="window-visual-example">
            <div class="wv-label">–õ—ñ—á–∏–ª—å–Ω–∏–∫ —Å–µ—Ä–≤–µ—Ä–∞: 3</div>
            <div class="wv-label">–í—ñ–∫–Ω–æ: 5</div>
            <div class="wv-counters">
              <div class="wv-counter current">3</div>
              <div class="wv-counter in-window">4</div>
              <div class="wv-counter in-window">5</div>
              <div class="wv-counter in-window">6</div>
              <div class="wv-counter in-window">7</div>
              <div class="wv-counter in-window">8</div>
              <div class="wv-counter outside">9</div>
              <div class="wv-counter outside">10</div>
            </div>
            <p class="wv-note">–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å C=3, 4, 5, 6, 7, 8. –Ø–∫—â–æ –ø–∞—Ä–æ–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î C=5, —Å–µ—Ä–≤–µ—Ä –æ–Ω–æ–≤–∏—Ç—å —Å–≤—ñ–π –ª—ñ—á–∏–ª—å–Ω–∏–∫ –¥–æ 6.</p>
          </div>
        </div>
      </div>

      <!-- Summary -->
      <div class="tutorial-section summary-section">
        <h2 data-i18n="algo-summary-title">–ü—ñ–¥—Å—É–º–æ–∫</h2>

        <div class="summary-flow">
          <div class="sf-step">
            <div class="sf-icon">üî¢</div>
            <div class="sf-text">
              <strong>Counter ‚Üí 8 –±–∞–π—Ç</strong>
              <p>Big-Endian</p>
            </div>
          </div>
          <div class="sf-arrow">‚Üí</div>
          <div class="sf-step">
            <div class="sf-icon">üîê</div>
            <div class="sf-text">
              <strong>HMAC-SHA1</strong>
              <p>20 –±–∞–π—Ç</p>
            </div>
          </div>
          <div class="sf-arrow">‚Üí</div>
          <div class="sf-step">
            <div class="sf-icon">‚úÇÔ∏è</div>
            <div class="sf-text">
              <strong>Truncate</strong>
              <p>31 –±—ñ—Ç</p>
            </div>
          </div>
          <div class="sf-arrow">‚Üí</div>
          <div class="sf-step">
            <div class="sf-icon">‚ûó</div>
            <div class="sf-text">
              <strong>mod 10‚Å∂</strong>
              <p>6 —Ü–∏—Ñ—Ä</p>
            </div>
          </div>
        </div>

        <div class="key-takeaways">
          <h3 data-i18n="algo-key-takeaways">–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏</h3>
          <ul>
            <li><strong>Dynamic Truncation ‚Äî –∑ HOTP, –Ω–µ –∑ TOTP!</strong> TOTP –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î HOTP.</li>
            <li><strong>31 –±—ñ—Ç, –Ω–µ 32</strong> ‚Äî —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º –∑—ñ –∑–Ω–∞–∫–æ–≤–∏–º–∏ —á–∏—Å–ª–∞–º–∏.</li>
            <li><strong>Offset –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç—É</strong> ‚Äî –¥–æ–¥–∞—î –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—Å—Ç—ñ.</li>
            <li><strong>–°–µ—Ä–≤–µ—Ä —Ä–æ–±–∏—Ç—å —Ç—É —Å–∞–º—É –º–∞—Ç–µ–º–∞—Ç–∏–∫—É</strong>, –∞–ª–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∫—ñ–ª—å–∫–∞ –∑–Ω–∞—á–µ–Ω—å.</li>
            <li><strong>Big-Endian</strong> ‚Äî —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç –ø–µ—Ä—à–∏–º –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ.</li>
          </ul>
        </div>
      </div>

    </article>
  </section>

  <!-- Data Structure Section -->
  <section id="section-data" class="tab-content">
    <article class="about-content">
      <h2 id="data-title">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö HOTP —Å–∏—Å—Ç–µ–º–∏</h2>

      <h3 id="data-overview-title">–û–≥–ª—è–¥ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏</h3>
      <pre class="about-pre" id="data-overview-text">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        HOTP –°–ò–°–¢–ï–ú–ê                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ         –ö–õ–Ü–Ñ–ù–¢              ‚îÇ              –°–ï–†–í–ï–†                   ‚îÇ
‚îÇ      (–¢–æ–∫–µ–Ω/–î–æ–¥–∞—Ç–æ–∫)        ‚îÇ         (–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è)              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                             ‚îÇ                                       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á K    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚î§ –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á K (–≤ –ë–î)     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ (–∑–∞—Ö–∏—â–µ–Ω–∞ –ø–∞–º'—è—Ç—å)  ‚îÇ    ‚îÇ    ‚îÇ (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π)                ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ           ‚îÇ                 ‚îÇ                ‚îÇ                      ‚îÇ
‚îÇ           ‚ñº                 ‚îÇ                ‚ñº                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ –õ—ñ—á–∏–ª—å–Ω–∏–∫ C         ‚îÇ    ‚îÇ    ‚îÇ –õ—ñ—á–∏–ª—å–Ω–∏–∫ C (–≤ –ë–î)          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ (–∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è)      ‚îÇ    ‚îÇ    ‚îÇ (–æ—Å—Ç–∞–Ω–Ω—ñ–π —É—Å–ø—ñ—à–Ω–∏–π)         ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ           ‚îÇ                 ‚îÇ                ‚îÇ                      ‚îÇ
‚îÇ           ‚ñº                 ‚îÇ                ‚ñº                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ HOTP(K, C) ‚Üí OTP    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ OTP               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ C = C + 1           ‚îÇ    ‚îÇ    ‚îÇ –¥–ª—è C, C+1, ..., C+window   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                             ‚îÇ                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      </pre>

      <h3 id="data-client-title">–î–∞–Ω—ñ –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ (—Ç–æ–∫–µ–Ω)</h3>
      <pre class="about-pre" id="data-client-text">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –¢–û–ö–ï–ù / –ú–û–ë–Ü–õ–¨–ù–ò–ô –î–û–î–ê–¢–û–ö                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ –ó–∞—Ö–∏—â–µ–Ω–∞ –ø–∞–º'—è—Ç—å (Secure Element / Keychain):               ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ secret_key: [u8; 20]                                    ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ü—Ä–∏–∫–ª–∞–¥: 0x48 0x65 0x6C 0x6C 0x6F 0x21 0xDE 0xAD ...  ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ê–±–æ Base32: JBSWY3DPEHPK3PXP                          ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ –ó–≤–∏—á–∞–π–Ω–∞ –ø–∞–º'—è—Ç—å:                                           ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ counter: u64 = 0                                        ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ó–±—ñ–ª—å—à—É—î—Ç—å—Å—è –Ω–∞ 1 –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó              ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –º—ñ–∂ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º–∏                   ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ –¢–∏–º—á–∞—Å–æ–≤—ñ –¥–∞–Ω—ñ (–Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è):                           ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ current_otp: String = "------"                          ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π OTP –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É         ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      </pre>

      <h3 id="data-server-title">–î–∞–Ω—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ</h3>
      <pre class="about-pre" id="data-server-text">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–ï–†–í–ï–† –ê–£–¢–ï–ù–¢–ò–§–Ü–ö–ê–¶–Ü–á                                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (—Ç–∞–±–ª–∏—Ü—è otp_secrets):              ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ CREATE TABLE otp_secrets (                              ‚îÇ ‚îÇ
‚îÇ ‚îÇ   user_id        INTEGER PRIMARY KEY,                   ‚îÇ ‚îÇ
‚îÇ ‚îÇ   username       VARCHAR(255) NOT NULL,                 ‚îÇ ‚îÇ
‚îÇ ‚îÇ   secret_key     BLOB NOT NULL,  -- 20 –±–∞–π—Ç, —à–∏—Ñ—Ä–æ–≤–∞–Ω–æ  ‚îÇ ‚îÇ
‚îÇ ‚îÇ   counter        BIGINT DEFAULT 0,                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ   failed_attempts INTEGER DEFAULT 0,                    ‚îÇ ‚îÇ
‚îÇ ‚îÇ   locked_until   TIMESTAMP NULL,                        ‚îÇ ‚îÇ
‚îÇ ‚îÇ   created_at     TIMESTAMP DEFAULT CURRENT_TIMESTAMP,   ‚îÇ ‚îÇ
‚îÇ ‚îÇ   last_used_at   TIMESTAMP NULL                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ );                                                      ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤–µ—Ä–∞:                                       ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ look_ahead_window: u32 = 5                              ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –≤–∏–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ                                                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ max_failed_attempts: u32 = 3                            ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—ñ—Å–ª—è N –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ                                                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ lockout_duration: Duration = 30 minutes                 ‚îÇ ‚îÇ
‚îÇ ‚îÇ   –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è                                 ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç—É (—Ç–∞–±–ª–∏—Ü—è otp_audit_log):                      ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ CREATE TABLE otp_audit_log (                            ‚îÇ ‚îÇ
‚îÇ ‚îÇ   id          INTEGER PRIMARY KEY,                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ   user_id     INTEGER NOT NULL,                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ   event_type  VARCHAR(50),  -- 'success', 'failure'     ‚îÇ ‚îÇ
‚îÇ ‚îÇ   counter_used BIGINT,                                  ‚îÇ ‚îÇ
‚îÇ ‚îÇ   ip_address  VARCHAR(45),                              ‚îÇ ‚îÇ
‚îÇ ‚îÇ   user_agent  TEXT,                                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ   timestamp   TIMESTAMP DEFAULT CURRENT_TIMESTAMP       ‚îÇ ‚îÇ
‚îÇ ‚îÇ );                                                      ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      </pre>

      <h3 id="data-flow-title">–ü–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö –ø—Ä–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó</h3>
      <pre class="about-pre" id="data-flow-text">
–ö—Ä–æ–∫ 1: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è OTP –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
   –ö–ª—ñ—î–Ω—Ç
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ K = secret_key    ‚îÇ
   ‚îÇ C = counter = 3   ‚îÇ
   ‚îÇ                   ‚îÇ
   ‚îÇ OTP = HOTP(K, C)  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫  –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å: 482937
   ‚îÇ     = 482937      ‚îÇ
   ‚îÇ                   ‚îÇ
   ‚îÇ counter = 4       ‚îÇ  ‚óÑ‚îÄ‚îÄ –õ—ñ—á–∏–ª—å–Ω–∏–∫ –∑–±—ñ–ª—å—à–µ–Ω–æ!
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–¥–∞—á–∞ OTP (–Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –∫–∞–Ω–∞–ª - OK!)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
   –ö–ª—ñ—î–Ω—Ç ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –°–µ—Ä–≤–µ—Ä
            username: "alice"
            otp: "482937"

   ‚ö†Ô∏è –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏, –ê–õ–ï:
      - OTP –¥—ñ–π—Å–Ω–∏–π –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑
      - –ü–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∏–≥–Ω—É—Ç–∏ –¥–æ –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–ö—Ä–æ–∫ 3: –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
   –°–µ—Ä–≤–µ—Ä
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ user = find_user("alice")                     ‚îÇ
   ‚îÇ K = decrypt(user.secret_key)                  ‚îÇ
   ‚îÇ C = user.counter = 2                          ‚îÇ
   ‚îÇ window = 5                                    ‚îÇ
   ‚îÇ                                               ‚îÇ
   ‚îÇ for i in 0..window:                           ‚îÇ
   ‚îÇ   expected = HOTP(K, C + i)                   ‚îÇ
   ‚îÇ   if expected == received_otp:                ‚îÇ
   ‚îÇ     user.counter = C + i + 1  ‚óÑ‚îÄ‚îÄ –û–Ω–æ–≤–ª–µ–Ω–Ω—è!  ‚îÇ
   ‚îÇ     return SUCCESS                            ‚îÇ
   ‚îÇ                                               ‚îÇ
   ‚îÇ C=2: HOTP = 847291 ‚â† 482937                   ‚îÇ
   ‚îÇ C=3: HOTP = 482937 = 482937 ‚úì                 ‚îÇ
   ‚îÇ                                               ‚îÇ
   ‚îÇ user.counter = 4  ‚óÑ‚îÄ‚îÄ –¢–µ–ø–µ—Ä —Å–µ—Ä–≤–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–∏–π
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      </pre>

      <h3 id="data-sync-title">–ü—Ä–æ–±–ª–µ–º–∞ –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó</h3>
      <pre class="about-pre" id="data-sync-text">
–°—Ü–µ–Ω–∞—Ä—ñ–π: –ö–ª—ñ—î–Ω—Ç –∑–≥–µ–Ω–µ—Ä—É–≤–∞–≤ –ø–∞—Ä–æ–ª—ñ, –∞–ª–µ –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ —ó—Ö
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω:
  –ö–ª—ñ—î–Ω—Ç: counter = 5
  –°–µ—Ä–≤–µ—Ä: counter = 5

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–ø–∞–¥–∫–æ–≤–æ –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É 3 —Ä–∞–∑–∏:
  –ö–ª—ñ—î–Ω—Ç: counter = 8  (–∑–≥–µ–Ω–µ—Ä—É–≤–∞–≤ OTP –¥–ª—è 5, 6, 7)
  –°–µ—Ä–≤–µ—Ä: counter = 5  (–Ω—ñ—á–æ–≥–æ –Ω–µ –æ—Ç—Ä–∏–º–∞–≤)

–¢–µ–ø–µ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ö–æ—á–µ —É–≤—ñ–π—Ç–∏:
  –ö–ª—ñ—î–Ω—Ç –≥–µ–Ω–µ—Ä—É—î OTP –¥–ª—è counter = 8
  –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î: 5, 6, 7, 8, 9 (window = 5)

  ‚úì OTP –¥–ª—è counter = 8 –∑–Ω–∞–π–¥–µ–Ω–æ —É –≤—ñ–∫–Ω—ñ!
  –°–µ—Ä–≤–µ—Ä –æ–Ω–æ–≤–ª—é—î: counter = 9

–Ø–∫–±–∏ window –±—É–≤ –º–µ–Ω—à–∏–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 2):
  –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î: 5, 6
  ‚úó OTP –¥–ª—è counter = 8 –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!
  –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π!

–†—ñ—à–µ–Ω–Ω—è: –†–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
  1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å 2-3 –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö OTP
  2. –°–µ—Ä–≤–µ—Ä —à—É–∫–∞—î —Ü—ñ OTP –≤ –≤–µ–ª–∏–∫–æ–º—É –≤—ñ–∫–Ω—ñ (100-1000)
  3. –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–∞
      </pre>
    </article>
  </section>

  <!-- About Section -->
  <section id="section-about" class="tab-content">
    <article class="about-content">
      <h2 id="about-title">–ü—Ä–æ HOTP ‚Äî RFC 4226</h2>

      <h3 id="about-history-title">–Ü—Å—Ç–æ—Ä—ñ—è —Ç–∞ —Ä–æ–∑—Ä–æ–±–∫–∞</h3>
      <p class="about-text" id="about-history-text">
RFC 4226 "HOTP: An HMAC-Based One-Time Password Algorithm" –±—É–≤ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–∏–π
—É –≥—Ä—É–¥–Ω—ñ 2005 —Ä–æ–∫—É. –ê–≤—Ç–æ—Ä–∏: D. M'Raihi (Verisign), M. Bellare (UCSD),
F. Hoornaert (Vasco), D. Naccache (ENS), O. Ranen (Aladdin).

–°—Ç–∞–Ω–¥–∞—Ä—Ç –±—É–≤ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π OATH (Initiative for Open Authentication) ‚Äî
–ø—Ä–æ–º–∏—Å–ª–æ–≤–∏–º –∫–æ–Ω—Å–æ—Ä—Ü—ñ—É–º–æ–º, —â–æ –æ–±'—î–¥–Ω—É—î —Ç–∞–∫—ñ –∫–æ–º–ø–∞–Ω—ñ—ó —è–∫ Verisign,
RSA Security, Symantec —Ç–∞ —ñ–Ω—à—ñ.
      </p>

      <h3 id="about-vs-totp-title">HOTP vs TOTP</h3>
      <pre class="about-pre" id="about-vs-totp-text">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞       ‚îÇ HOTP (RFC 4226)      ‚îÇ TOTP (RFC 6238)      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –†—ñ–∫ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó       ‚îÇ 2005                 ‚îÇ 2011                 ‚îÇ
‚îÇ –û—Å–Ω–æ–≤–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞    ‚îÇ –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–∏–π         ‚îÇ –ß–∞—Å–æ–≤–∏–π              ‚îÇ
‚îÇ –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è        ‚îÇ –ü–æ—Ç—Ä—ñ–±–Ω–µ –≤—ñ–∫–Ω–æ       ‚îÇ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ (—á–∞—Å)    ‚îÇ
‚îÇ –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó OTP       ‚îÇ –î–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è      ‚îÇ 30 —Å–µ–∫—É–Ω–¥            ‚îÇ
‚îÇ –§—ñ–∑–∏—á–Ω–∏–π —Ç–æ–∫–µ–Ω       ‚îÇ –Ü–¥–µ–∞–ª—å–Ω–∏–π            ‚îÇ –ü–æ—Ç—Ä—ñ–±–µ–Ω –≥–æ–¥–∏–Ω–Ω–∏–∫    ‚îÇ
‚îÇ –ú–æ–±—ñ–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫    ‚îÇ –ú–æ–∂–ª–∏–≤–∏–π             ‚îÇ –Ü–¥–µ–∞–ª—å–Ω–∏–π            ‚îÇ
‚îÇ –ü—Ä–∏–∫–ª–∞–¥              ‚îÇ RSA SecurID (—Å—Ç–∞—Ä—ñ)  ‚îÇ Google Authenticator ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      </pre>

      <h3 id="about-usage-title">–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–≤—ñ—Ç—ñ</h3>
      <p class="about-text" id="about-usage-text">
HOTP —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤:
‚Ä¢ –ê–ø–∞—Ä–∞—Ç–Ω–∏—Ö —Ç–æ–∫–µ–Ω–∞—Ö (RSA SecurID, YubiKey)
‚Ä¢ –ë–∞–Ω–∫—ñ–≤—Å—å–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
‚Ä¢ VPN –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
‚Ä¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–æ—Å—Ç—É–ø—É

TOTP (–Ω–∞ –æ—Å–Ω–æ–≤—ñ HOTP) –±—ñ–ª—å—à –ø–æ–ø—É–ª—è—Ä–Ω–∏–π –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤ —á–µ—Ä–µ–∑
–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é —á–∞—Å—É. Google Authenticator, Microsoft
Authenticator, Authy ‚Äî –≤—Å—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å TOTP.
      </p>

      <h3 id="about-security-title">–ê–Ω–∞–ª—ñ–∑ –±–µ–∑–ø–µ–∫–∏</h3>
      <p class="about-text" id="about-security-text">
<strong>–°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏:</strong>
‚Ä¢ –ë–∞–∑—É—î—Ç—å—Å—è –Ω–∞ HMAC-SHA1 ‚Äî –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ —Å—Ç—ñ–π–∫–∏–π
‚Ä¢ –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ replay-–∞—Ç–∞–∫ (–ª—ñ—á–∏–ª—å–Ω–∏–∫)
‚Ä¢ –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è

<strong>–°–ª–∞–±–∫—ñ —Å—Ç–æ—Ä–æ–Ω–∏:</strong>
‚Ä¢ –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –ª—ñ—á–∏–ª—å–Ω–∏–∫—ñ–≤
‚Ä¢ –ü–æ—Ç—Ä—ñ–±–Ω–æ –±–µ–∑–ø–µ—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –Ω–∞ –æ–±–æ—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö
‚Ä¢ SHA-1 —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ –º–∞—î –∫–æ–ª—ñ–∑—ñ—ó (–∞–ª–µ –¥–ª—è HMAC —Ü–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

<strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó RFC 4226:</strong>
‚Ä¢ –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –∫–ª—é—á–∞: 128 –±—ñ—Ç
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –∫–ª—é—á–∞: 160 –±—ñ—Ç (20 –±–∞–π—Ç)
‚Ä¢ Throttling –ø—ñ—Å–ª—è –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±
‚Ä¢ Secure storage –¥–ª—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
      </p>

      <h3 id="about-links-title">–ü–æ—Å–∏–ª–∞–Ω–Ω—è</h3>
      <p class="about-text" id="about-links-text">
‚Ä¢ <a href="https://datatracker.ietf.org/doc/html/rfc4226" target="_blank">RFC 4226 ‚Äî HOTP Algorithm</a>
‚Ä¢ <a href="https://datatracker.ietf.org/doc/html/rfc6238" target="_blank">RFC 6238 ‚Äî TOTP Algorithm</a>
‚Ä¢ <a href="https://openauthentication.org/" target="_blank">OATH ‚Äî Open Authentication</a>
      </p>
    </article>
  </section>

</body>
</html>
